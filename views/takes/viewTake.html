{{right_sidebar_enabled=True}}
{{extend 'layout.html'}}

{{block right_sidebar}}
{{
fileName = "defaultMale.png"
if("defaultMale.png" in fileName):
    =IMG(_src=URL('static', fileName), _alt="DP",_width="200px",_height="200px")
else:
    =IMG(_src=URL("default","download/" + fileName), _alt="DP",_width="200px",_height="200px")
pass
}}
<br/>
{{end}}


<div class='likeCount' id = 'takeLikeCount'>
	({{=numberOfLikes}})
</div>

{{ if(auth.is_logged_in()): }}
	<div class="likeLink">
		<a id="takeLike" onclick="ajax('{{=URL('takes', 'echo')}}', ['name'], 'takeLike')">
		    {{
		        if(isTakeLiked):
		            ="Unlike"
		        else:
		            ="Like"
		        pass
		    }}
		</a>
	</div>
{{ pass }}

<br/>
{{ if editLink!="": }}
	<a href='{{=editLink}}'>Edit</a>
	<a href='{{=deleteLink}}'><font color = "red">Delete</font></a>
	<br/>
	<br/>
{{pass}}

{{=XML(takeContent)}}
<br/>
<br/>
{{=form}}
<br/>
<br/>

{{
index = 0
viewerId = (auth.user.id) if (auth.is_logged_in()) else 0
for row in comments:
    userId = row.auth_user.id
    userName = row.auth_user.first_name + " " + row.auth_user.last_name
    commentContent = row.comments.commentContent
    commentId = row.comments.id
    commentLikeLink = URL('takes','changeLikeStatus',vars=dict(articleId = commentId, articleType = "Comment"))
    commentLikeAction = ("Unlike") if (isCommentLiked[index]) else "Like"
}}

<div class='likeCount' id = '{{="commentLikeCount" + str(index)}}'>
	({{=commentLikeCount[index]}})
</div>

{{ if(auth.is_logged_in()): }}
	<div class="likeLink">
		<a id = '{{="commentLike" + str(index)}}' onclick="ajax('{{=URL('takes', 'echo')}}', ['name'], '{{='commentLike' + str(index)}}')" >
			{{=commentLikeAction}}
		</a>
	</div>
{{ pass }}

<a href="{{=URL('users','profile',vars=dict(userId = userId))}}">{{=userName}}</a> : {{=commentContent}}
<br/>
{{
    if(viewerId==userId):
}}
	<a href="{{=URL('takes','deleteComment',vars=dict(takeId= takeId, commentId = commentId))}}"><font color = "red">Delete Comment</font></a>
	<br/>
{{
    pass
}}
<br/>
{{
	index = index + 1
	pass
}}
